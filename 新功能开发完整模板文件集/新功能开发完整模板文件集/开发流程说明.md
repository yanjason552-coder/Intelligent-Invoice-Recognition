# 新功能开发流程说明

## 开发流程概览

### 阶段1：需求分析与设计
1. **需求分析**：明确功能需求、业务规则、用户交互流程
2. **数据库设计**：设计表结构、字段、索引、约束
3. **API设计**：定义接口规范、请求响应格式
4. **界面设计**：设计页面布局、组件结构

### 阶段2：数据库层开发
1. **创建SQL脚本**：编写表结构创建脚本
2. **创建数据模型**：编写SQLModel模型类
3. **执行数据库迁移**：运行SQL脚本创建表

### 阶段3：后端API开发
1. **创建API路由**：编写FastAPI路由函数
2. **注册路由**：在main.py中注册新路由
3. **API测试**：使用Postman测试接口

### 阶段4：前端界面开发
1. **创建API客户端**：编写前端API调用代码
2. **创建页面组件**：编写页面组件
3. **创建编辑组件**：编写编辑/表单组件
4. **配置路由**：添加前端路由配置

### 阶段5：测试与部署
1. **功能测试**：测试CRUD操作
2. **集成测试**：前后端联调
3. **部署上线**：更新生产环境

## 详细步骤

### 阶段1：需求分析与设计

#### 1.1 需求分析
- 明确新功能的业务需求
- 定义功能边界和用户交互流程
- 确定数据结构和业务规则
- 设计API接口规范

#### 1.2 数据库设计
- 设计主表结构（遵循PostgreSQL规范）
- 设计关联表结构（如需要）
- 定义字段类型、约束和索引
- 考虑数据完整性和性能优化

### 阶段2：数据库层开发

#### 2.1 创建数据库表
- 在`backend/`目录下创建SQL文件
- 定义表结构、字段、索引、约束
- 添加表注释和字段注释

#### 2.2 创建数据模型
- 在`backend/app/`目录下创建`models_*.py`文件
- 定义基础模型、创建模型、更新模型、数据库模型、公共模型
- 添加字段验证和关系定义

#### 2.3 执行数据库迁移
- 运行SQL脚本创建表结构
- 验证表结构是否正确创建

### 阶段3：后端API开发

#### 3.1 创建API路由
- 在`backend/app/api/routes/`目录下创建路由文件
- 实现CRUD操作（创建、读取、更新、删除）
- 添加数据验证和错误处理
- 实现分页、搜索、过滤功能

#### 3.2 注册路由
- 在`backend/app/api/main.py`中注册新路由
- 添加API标签和描述

#### 3.3 API测试
- 使用Postman或curl测试接口
- 验证所有CRUD操作
- 测试错误处理和数据验证

### 阶段4：前端界面开发

#### 4.1 创建API客户端
- 在`frontend/src/client/`目录下创建API调用文件
- 定义TypeScript接口类型
- 实现API调用方法

#### 4.2 创建页面组件
- 在`frontend/src/routes/`目录下创建页面文件
- 实现列表展示、搜索、过滤功能
- 添加分页和批量操作

#### 4.3 创建编辑组件
- 在`frontend/src/components/`目录下创建编辑组件
- 实现表单验证和数据提交
- 添加模态框和确认对话框

#### 4.4 配置路由
- 在路由文件中添加新页面路由
- 更新导航菜单

### 阶段5：测试与部署

#### 5.1 功能测试
- 测试所有CRUD操作
- 验证数据验证和错误处理
- 测试搜索、过滤、分页功能

#### 5.2 集成测试
- 前后端联调测试
- 验证数据一致性
- 测试用户权限控制

#### 5.3 部署上线
- 更新生产数据库
- 部署后端代码
- 部署前端代码
- 验证生产环境功能

## 开发规范

### 代码组织
- 按功能模块组织代码
- 保持单一职责原则
- 使用TypeScript提供类型安全
- 遵循RESTful API设计原则

### 错误处理
- 统一的错误响应格式
- 适当的HTTP状态码
- 用户友好的错误提示

### 性能优化
- 为常用查询字段添加索引
- 使用分页查询避免大量数据加载
- 前端使用虚拟滚动处理大数据量
- 合理使用缓存机制

## 开发工具

### 后端开发
- IDE：VS Code、PyCharm
- 数据库工具：pgAdmin、DBeaver
- API测试：Postman、curl
- 版本控制：Git

### 前端开发
- IDE：VS Code
- 浏览器开发工具
- React Developer Tools
- 版本控制：Git

## 质量保证

### 代码审查
- 检查SQL注入风险
- 验证权限控制
- 确认数据验证逻辑
- 检查错误处理
- 验证前端用户体验

### 测试策略
- 单元测试：测试单个函数和组件
- 集成测试：测试API接口和数据库交互
- 端到端测试：测试完整用户流程
- 性能测试：测试系统性能指标

## 部署策略

### 开发环境
- 本地开发环境
- 开发数据库
- 热重载和调试工具

### 测试环境
- 独立的测试环境
- 测试数据库
- 自动化测试流程

### 生产环境
- 生产服务器
- 生产数据库
- 监控和日志系统
